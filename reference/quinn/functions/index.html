
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mrpowers.github.io/quinn/reference/quinn/functions/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.7">
    
    
      
        <title>Functions - Quinn</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quinn.functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Quinn" class="md-header__button md-logo" aria-label="Quinn" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Quinn
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Functions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/MrPowers/quinn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    MrPowers/quinn
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../usage/" class="md-tabs__link">
        
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../SUMMARY/" class="md-tabs__link">
        
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../examples/" class="md-tabs__link">
        
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../learn_more/" class="md-tabs__link">
        
  
    
  
  Learn more

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Quinn" class="md-nav__button md-logo" aria-label="Quinn" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Quinn
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MrPowers/quinn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    MrPowers/quinn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../SUMMARY/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../examples/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/schema_as_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Print SCHEMA as code
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../learn_more/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Learn more
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Learn more
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../learn_more/column_to_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Column to list performance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quinn.functions" class="md-nav__link">
    quinn.functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.anti_trim" class="md-nav__link">
    anti_trim()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.approx_equal" class="md-nav__link">
    approx_equal()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.array_choice" class="md-nav__link">
    array_choice()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.business_days_between" class="md-nav__link">
    business_days_between()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.exists" class="md-nav__link">
    exists()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.forall" class="md-nav__link">
    forall()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.is_false" class="md-nav__link">
    is_false()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.is_falsy" class="md-nav__link">
    is_falsy()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.is_not_in" class="md-nav__link">
    is_not_in()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.is_null_or_blank" class="md-nav__link">
    is_null_or_blank()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.is_true" class="md-nav__link">
    is_true()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.is_truthy" class="md-nav__link">
    is_truthy()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.multi_equals" class="md-nav__link">
    multi_equals()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.null_between" class="md-nav__link">
    null_between()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.remove_all_whitespace" class="md-nav__link">
    remove_all_whitespace()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.remove_non_word_characters" class="md-nav__link">
    remove_non_word_characters()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.single_space" class="md-nav__link">
    single_space()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.uuid5" class="md-nav__link">
    uuid5()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.week_end_date" class="md-nav__link">
    week_end_date()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quinn.functions.week_start_date" class="md-nav__link">
    week_start_date()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Functions</h1>

<div class="doc doc-object doc-module">


<a id="quinn.functions"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="quinn.functions.anti_trim" class="doc doc-heading">
<code class="highlight language-python"><span class="n">anti_trim</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Remove all inner whitespace but retain leading and trailing whitespace.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>Column on which to perform the regexp_replace.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>A new Column with all inner whitespace removed but leading and trailing whitespace retained.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">anti_trim</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove all inner whitespace but retain leading and trailing whitespace.</span>

<span class="sd">    :param col: Column on which to perform the regexp_replace.</span>
<span class="sd">    :type col: Column</span>
<span class="sd">    :return: A new Column with all inner whitespace removed but leading and trailing whitespace retained.</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">b</span><span class="se">\\</span><span class="s2">s+</span><span class="se">\\</span><span class="s2">b&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.approx_equal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">approx_equal</span><span class="p">(</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Compare two <code>Column</code> objects by checking if the difference between them is less than a specified <code>threshold</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col1</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>the first <code>Column</code></p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>col2</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>the second <code>Column</code></p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code><span title="numbers.Number">Number</span></code>
          </td>
          <td><p>value to compare with</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>Boolean <code>Column</code> with <code>True</code> indicating that <code>abs(col1 - col2)</code> is less than <code>threshold</code></p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">approx_equal</span><span class="p">(</span><span class="n">col1</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">col2</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="n">Number</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare two ``Column`` objects by checking if the difference between them is less than a specified ``threshold``.</span>

<span class="sd">    :param col1: the first ``Column``</span>
<span class="sd">    :type col1: Column</span>
<span class="sd">    :param col2: the second ``Column``</span>
<span class="sd">    :type col2: Column</span>
<span class="sd">    :param threshold: value to compare with</span>
<span class="sd">    :type threshold: Number</span>
<span class="sd">    :return: Boolean ``Column`` with ``True`` indicating that ``abs(col1 -</span>
<span class="sd">    col2)`` is less than ``threshold``</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">col1</span> <span class="o">-</span> <span class="n">col2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.array_choice" class="doc doc-heading">
<code class="highlight language-python"><span class="n">array_choice</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns one random element from the given column.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>Column from which element is chosen</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>random element from the given column</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">array_choice</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns one random element from the given column.</span>

<span class="sd">    :param col: Column from which element is chosen</span>
<span class="sd">    :type col: Column</span>
<span class="sd">    :return: random element from the given column</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">col</span><span class="p">))</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">col</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.business_days_between" class="doc doc-heading">
<code class="highlight language-python"><span class="n">business_days_between</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function takes two Spark <code>Columns</code> and returns a <code>Column</code> with the number of business days between the start and the end date.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>start_date</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>The column with the start dates</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>end_date</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>The column with the end dates</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>a Column with the number of business days between the start and the end date</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">business_days_between</span><span class="p">(</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">end_date</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function takes two Spark `Columns` and returns a `Column` with the number of business days between the start and the end date.</span>

<span class="sd">    :param start_date: The column with the start dates</span>
<span class="sd">    :type start_date: Column</span>
<span class="sd">    :param end_date: The column with the end dates</span>
<span class="sd">    :type end_date: Column</span>
<span class="sd">    :returns: a Column with the number of business days between the start and the end date</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_days</span> <span class="o">=</span> <span class="s2">&quot;sequence(start_date, end_date)&quot;</span>
    <span class="n">days_of_week</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;transform(</span><span class="si">{</span><span class="n">all_days</span><span class="si">}</span><span class="s2">, x -&gt; date_format(x, &#39;E&#39;))&quot;</span>
    <span class="n">filter_weekends</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;filter(</span><span class="si">{</span><span class="n">days_of_week</span><span class="si">}</span><span class="s2">, x -&gt; x NOT IN (&#39;Sat&#39;, &#39;Sun&#39;))&quot;</span><span class="p">)</span>
    <span class="n">num_business_days</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">filter_weekends</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">num_business_days</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">num_business_days</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.exists" class="doc doc-heading">
<code class="highlight language-python"><span class="n">exists</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Create a user-defined function.</p>
<p>It takes a list expressed as a column of type <code>ArrayType(AnyType)</code> as an argument and returns a boolean value indicating
whether any element in the list is true according to the argument <code>f</code> of the <code>exists()</code> function.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>f</code></td>
          <td>
                <code><span title="collections.abc.Callable">Callable</span>[[<span title="typing.Any">Any</span>], bool]</code>
          </td>
          <td><p>Callable function - A callable function that takes an element of type Any and returns a boolean value.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>UserDefinedFunction</code>
          </td>
          <td><p>A user-defined function that takes a list expressed as a column of type ArrayType(AnyType) as an argument and returns a boolean value indicating whether any element in the list is true according to the argument <code>f</code> of the <code>exists()</code> function.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">exists</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">udf</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a user-defined function.</span>

<span class="sd">    It takes a list expressed as a column of type ``ArrayType(AnyType)`` as an argument and returns a boolean value indicating</span>
<span class="sd">    whether any element in the list is true according to the argument ``f`` of the ``exists()`` function.</span>

<span class="sd">    :param f: Callable function - A callable function that takes an element of</span>
<span class="sd">    type Any and returns a boolean value.</span>
<span class="sd">    :return: A user-defined function that takes</span>
<span class="sd">    a list expressed as a column of type ArrayType(AnyType) as an argument and</span>
<span class="sd">    returns a boolean value indicating whether any element in the list is true</span>
<span class="sd">    according to the argument ``f`` of the ``exists()`` function.</span>
<span class="sd">    :rtype: UserDefinedFunction</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">temp_udf</span><span class="p">(</span><span class="n">list_</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">list_</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">udf</span><span class="p">(</span><span class="n">temp_udf</span><span class="p">,</span> <span class="n">BooleanType</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.forall" class="doc doc-heading">
<code class="highlight language-python"><span class="n">forall</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>The <strong>forall</strong> function allows for mapping a given boolean function to a list of arguments and return a single boolean value.</p>
<p>It does this by creating a Spark UDF which takes in a list of arguments, applying the given boolean function to
each element of the list and returning a single boolean value if all the elements pass through the given boolean function.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>f</code></td>
          <td>
                <code><span title="collections.abc.Callable">Callable</span>[[<span title="typing.Any">Any</span>], bool]</code>
          </td>
          <td><p>A callable function <code>f</code> which takes in any type and returns a boolean</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>UserDefinedFunction</code>
          </td>
          <td><p>A spark UDF which accepts a list of arguments and returns True if all elements pass through the given boolean function, False otherwise.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forall</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">udf</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The **forall** function allows for mapping a given boolean function to a list of arguments and return a single boolean value.</span>

<span class="sd">    It does this by creating a Spark UDF which takes in a list of arguments, applying the given boolean function to</span>
<span class="sd">    each element of the list and returning a single boolean value if all the elements pass through the given boolean function.</span>

<span class="sd">    :param f: A callable function ``f`` which takes in any type and returns a boolean</span>
<span class="sd">    :return: A spark UDF which accepts a list of arguments and returns True if all</span>
<span class="sd">    elements pass through the given boolean function, False otherwise.</span>
<span class="sd">    :rtype: UserDefinedFunction</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">temp_udf</span><span class="p">(</span><span class="n">list_</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">list_</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">udf</span><span class="p">(</span><span class="n">temp_udf</span><span class="p">,</span> <span class="n">BooleanType</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.is_false" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_false</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function checks if the column is equal to False and returns the column.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>Column</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>Column</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_false</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function checks if the column is equal to False and returns the column.</span>

<span class="sd">    :param col: Column</span>
<span class="sd">    :return: Column</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">col</span> <span class="o">==</span> <span class="n">lit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.is_falsy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_falsy</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns a Column indicating whether all values in the Column are False or NULL (<strong>falsy</strong>).</p>
<p>Each element in the resulting column is True if all the elements in the
Column are either NULL or False, or False otherwise. This is accomplished by
performing a bitwise or of the <code>isNull</code> condition and a literal False value and
then wrapping the result in a <strong>when</strong> statement.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>Column object</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>Column object</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_falsy</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a Column indicating whether all values in the Column are False or NULL (**falsy**).</span>

<span class="sd">    Each element in the resulting column is True if all the elements in the</span>
<span class="sd">    Column are either NULL or False, or False otherwise. This is accomplished by</span>
<span class="sd">    performing a bitwise or of the ``isNull`` condition and a literal False value and</span>
<span class="sd">    then wrapping the result in a **when** statement.</span>

<span class="sd">    :param col: Column object</span>
<span class="sd">    :returns: Column object</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">when</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">|</span> <span class="p">(</span><span class="n">col</span> <span class="o">==</span> <span class="n">lit</span><span class="p">(</span><span class="kc">False</span><span class="p">)),</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.is_not_in" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_not_in</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">_list</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>To see if a value is not in a list of values.</p>
<p>:_list: list[Any]</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>Column object</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_not_in</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;To see if a value is not in a list of values.</span>

<span class="sd">    :param col: Column object</span>
<span class="sd">    :_list: list[Any]</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">~</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">_list</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.is_null_or_blank" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_null_or_blank</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns a Boolean value which expresses whether a given column is <code>null</code> or contains only blank characters.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>\*\*col</code></td>
          <td>
          </td>
          <td><p>The  :class:<code>Column</code> to check.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>A <code>Column</code> containing <code>True</code> if the column is <code>null</code> or only contains blank characters, or <code>False</code> otherwise.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_null_or_blank</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Returns a Boolean value which expresses whether a given column is ``null`` or contains only blank characters.</span>

<span class="sd">    :param \*\*col: The  :class:`Column` to check.</span>

<span class="sd">    :returns: A `Column` containing ``True`` if the column is ``null`` or only contains</span>
<span class="sd">    blank characters, or ``False`` otherwise.</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">isNull</span><span class="p">())</span> <span class="o">|</span> <span class="p">(</span><span class="n">trim</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.is_true" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_true</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function takes a column of type Column as an argument and returns a column of type Column.</p>
<p>It evaluates whether each element in the column argument is equal to True, and
if so will return True, otherwise False.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>Column object</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>Column object</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_true</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function takes a column of type Column as an argument and returns a column of type Column.</span>

<span class="sd">    It evaluates whether each element in the column argument is equal to True, and</span>
<span class="sd">    if so will return True, otherwise False.</span>

<span class="sd">    :param col: Column object</span>
<span class="sd">    :returns: Column object</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">col</span> <span class="o">==</span> <span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.is_truthy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_truthy</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Calculates a boolean expression that is the opposite of is_falsy for the given <code>Column</code> col.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code>Column</code>
          </td>
          <td><p>The <code>Column</code> to calculate the opposite of is_falsy for.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>A <code>Column</code> with the results of the calculation.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_truthy</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates a boolean expression that is the opposite of is_falsy for the given ``Column`` col.</span>

<span class="sd">    :param Column col: The ``Column`` to calculate the opposite of is_falsy for.</span>
<span class="sd">    :returns: A ``Column`` with the results of the calculation.</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">~</span><span class="p">(</span><span class="n">is_falsy</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.multi_equals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">multi_equals</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Create a user-defined function that checks if all the given columns have the designated value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>The designated value.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>UserDifinedFunction</code>
          </td>
          <td><p>A user-defined function of type BooleanType().</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">multi_equals</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">udf</span><span class="p">:</span>  <span class="c1"># noqa: ANN401</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a user-defined function that checks if all the given columns have the designated value.</span>

<span class="sd">    :param value: The designated value.</span>
<span class="sd">    :type value: Any</span>
<span class="sd">    :return: A user-defined function of type BooleanType().</span>
<span class="sd">    :rtype: UserDifinedFunction</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">temp_udf</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: ANN002</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">col</span> <span class="o">==</span> <span class="n">value</span><span class="p">,</span> <span class="n">cols</span><span class="p">))</span>  <span class="c1"># noqa: C417</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">udf</span><span class="p">(</span><span class="n">temp_udf</span><span class="p">,</span> <span class="n">BooleanType</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.null_between" class="doc doc-heading">
<code class="highlight language-python"><span class="n">null_between</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>To see if a value is between two values in a null friendly way.</p>
<p>:lower: Column
:upper: Column</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>Column object</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">null_between</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">lower</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;To see if a value is between two values in a null friendly way.</span>

<span class="sd">    :param col: Column object</span>
<span class="sd">    :lower: Column</span>
<span class="sd">    :upper: Column</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">when</span><span class="p">(</span><span class="n">lower</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">upper</span><span class="o">.</span><span class="n">isNull</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span>
        <span class="n">when</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">isNull</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span>
            <span class="n">when</span><span class="p">(</span><span class="n">lower</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">upper</span><span class="o">.</span><span class="n">isNotNull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">col</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span>
                <span class="n">when</span><span class="p">(</span>
                    <span class="n">lower</span><span class="o">.</span><span class="n">isNotNull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">upper</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">col</span> <span class="o">&gt;=</span> <span class="n">lower</span><span class="p">),</span>
                    <span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)),</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.remove_all_whitespace" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_all_whitespace</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function takes a <code>Column</code> object as a parameter and returns a <code>Column</code> object with all white space removed.</p>
<p>It does this using the regexp_replace function from F, which replaces all whitespace with an empty string.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>a <code>Column</code> object</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>a <code>Column</code> object with all white space removed</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_all_whitespace</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function takes a `Column` object as a parameter and returns a `Column` object with all white space removed.</span>

<span class="sd">    It does this using the regexp_replace function from F, which replaces all whitespace with an empty string.</span>

<span class="sd">    :param col: a `Column` object</span>
<span class="sd">    :type col: Column</span>
<span class="sd">    :returns: a `Column` object with all white space removed</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.remove_non_word_characters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_non_word_characters</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Removes non-word characters from a column.</p>
<p>The non-word characters which will be removed are those identified by the
regular expression <code>"[^\\w\\s]+"</code>.  This expression represents any character
that is not a word character (e.g. <code>\\w</code>) or whitespace (<code>\\s</code>).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>A Column object.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>A Column object with non-word characters removed.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_non_word_characters</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Removes non-word characters from a column.</span>

<span class="sd">    The non-word characters which will be removed are those identified by the</span>
<span class="sd">    regular expression ``&quot;[^\\w\\s]+&quot;``.  This expression represents any character</span>
<span class="sd">    that is not a word character (e.g. `\\w`) or whitespace (`\\s`).</span>

<span class="sd">    :param col: A Column object.</span>
<span class="sd">    :return: A Column object with non-word characters removed.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;[^</span><span class="se">\\</span><span class="s2">w</span><span class="se">\\</span><span class="s2">s]+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.single_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">single_space</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function takes a column and replaces all the multiple white spaces with a single space.</p>
<p>It then trims the column to make all the texts consistent.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>The column which needs to be spaced</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>A trimmed column with single space</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">single_space</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function takes a column and replaces all the multiple white spaces with a single space.</span>

<span class="sd">    It then trims the column to make all the texts consistent.</span>

<span class="sd">    :param col: The column which needs to be spaced</span>
<span class="sd">    :type col: Column</span>
<span class="sd">    :returns: A trimmed column with single space</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot; +&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.uuid5" class="doc doc-heading">
<code class="highlight language-python"><span class="n">uuid5</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">uuid</span><span class="o">.</span><span class="n">NAMESPACE_DNS</span><span class="p">,</span> <span class="n">extra_string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function generates UUIDv5 from <code>col</code> and <code>namespace</code>, optionally prepending an extra string to <code>col</code>.</p>
<p>Sets variant to RFC 4122 one.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>Column that will be hashed.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>namespace</code></td>
          <td>
                <code>uuid.<span title="uuid.UUID">UUID</span></code>
          </td>
          <td><p>Namespace to be used. (default: <code>uuid.NAMESPACE_DNS</code>)</p></td>
          <td>
                <code>uuid.NAMESPACE_DNS</code>
          </td>
        </tr>
        <tr>
          <td><code>extra_string</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>In case of collisions one can pass an extra string to hash on.</p></td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>String representation of generated UUIDv5</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">uuid5</span><span class="p">(</span>
    <span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span>
    <span class="n">namespace</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">NAMESPACE_DNS</span><span class="p">,</span>
    <span class="n">extra_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function generates UUIDv5 from ``col`` and ``namespace``, optionally prepending an extra string to ``col``.</span>

<span class="sd">    Sets variant to RFC 4122 one.</span>

<span class="sd">    :param col: Column that will be hashed.</span>
<span class="sd">    :type col: Column</span>
<span class="sd">    :param namespace: Namespace to be used. (default: `uuid.NAMESPACE_DNS`)</span>
<span class="sd">    :type namespace: str</span>
<span class="sd">    :param extra_string: In case of collisions one can pass an extra string to hash on.</span>
<span class="sd">    :type extra_string: str</span>
<span class="sd">    :return: String representation of generated UUIDv5</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">namespace</span><span class="o">.</span><span class="n">bytes</span><span class="p">)</span>
    <span class="n">salted_col</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">extra_string</span><span class="p">),</span> <span class="n">col</span><span class="p">)</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">salted_col</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="n">encoded_with_ns</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">encoded</span><span class="p">)</span>
    <span class="n">hashed</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">encoded_with_ns</span><span class="p">)</span>
    <span class="n">variant_part</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">substring</span><span class="p">(</span><span class="n">hashed</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">variant_part</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">variant_part</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">variant_part</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">lpad</span><span class="p">(</span><span class="n">variant_part</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
    <span class="n">variant_part</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;10&quot;</span><span class="p">),</span>
        <span class="n">F</span><span class="o">.</span><span class="n">substring</span><span class="p">(</span><span class="n">variant_part</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="p">)</span>  <span class="c1"># RFC 4122 variant.</span>
    <span class="n">variant_part</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">variant_part</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">concat_ws</span><span class="p">(</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">F</span><span class="o">.</span><span class="n">substring</span><span class="p">(</span><span class="n">hashed</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">F</span><span class="o">.</span><span class="n">substring</span><span class="p">(</span><span class="n">hashed</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="n">F</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;5&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">substring</span><span class="p">(</span><span class="n">hashed</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>  <span class="c1"># Set version.</span>
        <span class="n">variant_part</span><span class="p">,</span>
        <span class="n">F</span><span class="o">.</span><span class="n">substring</span><span class="p">(</span><span class="n">hashed</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.week_end_date" class="doc doc-heading">
<code class="highlight language-python"><span class="n">week_end_date</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">week_end_day</span><span class="o">=</span><span class="s1">&#39;Sat&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Return a date column for the end of week for a given day.</p>
<p>The Spark function <code>dayofweek</code> considers Sunday as the first day of the week, and
uses the default value of 1 to indicate Sunday. Usage of the <code>when</code> and <code>otherwise</code>
functions allow a comparison between the end of week day indicated and the day
of week computed, and the return of the reference date if they match or the the
addition of one week to the reference date otherwise.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>The reference date column.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>week_end_day</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The week end day (default: 'Sat')</p></td>
          <td>
                <code>&#39;Sat&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>A Column of end of the week dates.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">week_end_date</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">week_end_day</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Sat&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a date column for the end of week for a given day.</span>

<span class="sd">    The Spark function `dayofweek` considers Sunday as the first day of the week, and</span>
<span class="sd">    uses the default value of 1 to indicate Sunday. Usage of the `when` and `otherwise`</span>
<span class="sd">    functions allow a comparison between the end of week day indicated and the day</span>
<span class="sd">    of week computed, and the return of the reference date if they match or the the</span>
<span class="sd">    addition of one week to the reference date otherwise.</span>

<span class="sd">    :param col: The reference date column.</span>
<span class="sd">    :type col: Column</span>
<span class="sd">    :param week_end_day: The week end day (default: &#39;Sat&#39;)</span>
<span class="sd">    :type week_end_day: str</span>
<span class="sd">    :return: A Column of end of the week dates.</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_raise_if_invalid_day</span><span class="p">(</span><span class="n">week_end_day</span><span class="p">)</span>
    <span class="c1"># these are the default Spark mappings.  Spark considers Sunday the first day of the week.</span>
    <span class="n">day_of_week_mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Sun&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;Mon&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;Tue&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;Wed&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;Thu&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;Fri&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;Sat&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">(</span>
        <span class="n">F</span><span class="o">.</span><span class="n">dayofweek</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">eqNullSafe</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">day_of_week_mapping</span><span class="p">[</span><span class="n">week_end_day</span><span class="p">])),</span>
        <span class="n">col</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">next_day</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">week_end_day</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="quinn.functions.week_start_date" class="doc doc-heading">
<code class="highlight language-python"><span class="n">week_start_date</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">week_start_day</span><span class="o">=</span><span class="s1">&#39;Sun&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function takes a Spark <code>Column</code> and an optional <code>week_start_day</code> argument and returns a <code>Column</code> with the corresponding start of week dates.</p>
<p>The "standard week" in Spark starts on Sunday, however an optional argument can be
used to start the week from a different day, e.g. Monday. The <code>week_start_day</code>
argument is a string corresponding to the day of the week to start the week
from, e.g. <code>"Mon"</code>, <code>"Tue"</code>, and must be in the set: <code>{"Sun", "Mon", "Tue", "Wed",
"Thu", "Fri", "Sat"}</code>. If the argument given is not a valid day then a <code>ValueError</code>
will be raised.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td><p>The column to determine start of week dates on</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>week_start_day</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The day to start the week on</p></td>
          <td>
                <code>&#39;Sun&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Column</code>
          </td>
          <td><p>A Column with start of week dates</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>quinn/functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">week_start_date</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">week_start_day</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Sun&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function takes a Spark `Column` and an optional `week_start_day` argument and returns a `Column` with the corresponding start of week dates.</span>

<span class="sd">    The &quot;standard week&quot; in Spark starts on Sunday, however an optional argument can be</span>
<span class="sd">    used to start the week from a different day, e.g. Monday. The `week_start_day`</span>
<span class="sd">    argument is a string corresponding to the day of the week to start the week</span>
<span class="sd">    from, e.g. `&quot;Mon&quot;`, `&quot;Tue&quot;`, and must be in the set: `{&quot;Sun&quot;, &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;,</span>
<span class="sd">    &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;}`. If the argument given is not a valid day then a `ValueError`</span>
<span class="sd">    will be raised.</span>

<span class="sd">    :param col: The column to determine start of week dates on</span>
<span class="sd">    :type col: Column</span>
<span class="sd">    :param week_start_day: The day to start the week on</span>
<span class="sd">    :type week_start_day: str</span>
<span class="sd">    :returns: A Column with start of week dates</span>
<span class="sd">    :rtype: Column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_raise_if_invalid_day</span><span class="p">(</span><span class="n">week_start_day</span><span class="p">)</span>
    <span class="c1"># the &quot;standard week&quot; in Spark is from Sunday to Saturday</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Sun&quot;</span><span class="p">:</span> <span class="s2">&quot;Sat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mon&quot;</span><span class="p">:</span> <span class="s2">&quot;Sun&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tue&quot;</span><span class="p">:</span> <span class="s2">&quot;Mon&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Wed&quot;</span><span class="p">:</span> <span class="s2">&quot;Tue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Thu&quot;</span><span class="p">:</span> <span class="s2">&quot;Wed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Fri&quot;</span><span class="p">:</span> <span class="s2">&quot;Thu&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sat&quot;</span><span class="p">:</span> <span class="s2">&quot;Fri&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">week_end_date</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">mapping</span><span class="p">[</span><span class="n">week_start_day</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">date_add</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tracking", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "navigation.indexes", "navigation.expand", "content.tabs.link", "content.code.copy", "content.code.select"], "search": "../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>